<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart - Naija Style Co</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gold: '#CC1000',
                        'deep-black': '#0A0A0A',
                    },
                    fontFamily: {
                        cormorant: ['"Cormorant Garamond"', 'serif'],
                        inter: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; background: #ffffff; color: #111; }
        .brand-title { font-family: 'Cormorant Garamond', serif; }
        .gold-gradient { background: linear-gradient(135deg, #CC1000, #ff0c0c); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        
        /* Loading Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Mobile Menu */
        #mobile-menu {
            transform: translateX(100%);
            transition: transform 0.65s cubic-bezier(0.77, 0, 0.175, 1);
        }
        #mobile-menu.open { transform: translateX(0); }
        .mobile-link {
            opacity: 0;
            transform: translateY(40px);
            transition: all 0.7s cubic-bezier(0.77, 0, 0.175, 1);
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb {
            background: #CC1000;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a00d00;
        }
    </style>
</head>
<body class="bg-white">
    <!-- HEADER -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-xl border-b border-gray-100">
        <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
            <!-- Logo -->
            <a href="/" class="flex items-center space-x-3 group">
                <img src="/assets/images/logo.png" class="w-18 h-12 ml-2">
            </a>

            <!-- Desktop Nav -->
            <nav class="hidden lg:flex items-center space-x-12">
                <a href="/" class="text-deep-black hover:text-gold font-medium text-lg transition">Home</a>
                <a href="/products" class="text-deep-black hover:text-gold font-medium text-lg transition">Products</a>
                <a href="/about" class="text-deep-black hover:text-gold font-medium text-lg transition">About</a>
                <a href="/contact" class="text-deep-black hover:text-gold font-medium text-lg transition">Contact</a>
            </nav>

            <!-- Right Side -->
            <div class="flex items-center space-x-7">
                <!-- Cart -->
                <div class="relative group cursor-pointer" onclick="location.href='/cart'">
                    <i class="fas fa-shopping-bag text-2xl text-deep-black hover:text-gold transition"></i>
                    <span id="cart-badge" class="absolute -top-2 -right-2 bg-gold text-white text-xs font-bold rounded-full h-6 w-6 flex items-center justify-center shadow-lg">0</span>
                </div>

                <!-- User Section -->
                <div id="user-section"></div>

                <!-- Mobile Menu -->
                <button id="mobile-menu-btn" class="lg:hidden text-deep-black text-3xl">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- MOBILE MENU -->
    <div id="mobile-menu" class="fixed inset-0 bg-white text-black backdrop-blur-3xl z-40 hidden flex items-center justify-center">
        <button id="mobile-close" class="absolute top-8 right-8 text-black text-5xl hover:text-gold transition">
            <i class="fas fa-times"></i>
        </button>
        <nav class="text-center space-y-12">
            <a href="/" class="mobile-link block text-5xl font-light text-black hover:text-gold transition brand-title">Home</a>
            <a href="/products" class="mobile-link block text-5xl font-light text-black hover:text-gold transition brand-title">Products</a>
            <a href="/about" class="mobile-link block text-5xl font-light text-black hover:text-gold transition brand-title">About</a>
            <a href="/contact" class="mobile-link block text-5xl font-light text-black hover:text-gold transition brand-title">Contact</a>
            <div id="mobile-user-section" class="mobile-link pt-16"></div>
        </nav>
    </div>

    <!-- Cart Page Content -->
    <main class="pt-20">
        <div class="max-w-7xl mx-auto px-6 py-12">
            <!-- Page Header -->
            <div class="mb-8">
                <h1 class="brand-title text-4xl md:text-5xl font-bold text-deep-black mb-4">Your Shopping Cart</h1>
                <p class="text-gray-600">Review your items and proceed to checkout</p>
            </div>

            <!-- Cart Content -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Cart Items -->
                <div class="lg:col-span-2">
                    <!-- Loading State -->
                    <div id="cart-loading" class="space-y-4">
                        <div class="skeleton h-32 rounded-xl"></div>
                        <div class="skeleton h-32 rounded-xl"></div>
                        <div class="skeleton h-32 rounded-xl"></div>
                    </div>

                    <!-- Empty Cart -->
                    <div id="empty-cart" class="hidden text-center py-12">
                        <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="fas fa-shopping-cart text-4xl text-gray-400"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-700 mb-3">Your cart is empty</h3>
                        <p class="text-gray-600 mb-8">Add some amazing Nigerian fashion to your cart!</p>
                        <a href="/products" class="inline-block px-8 py-3 bg-gold text-white rounded-lg font-medium hover:bg-red-700 transition">
                            <i class="fas fa-arrow-left mr-2"></i>
                            Continue Shopping
                        </a>
                    </div>

                    <!-- Cart Items List -->
                    <div id="cart-items" class="hidden space-y-4">
                        <!-- Cart items will be loaded here -->
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="lg:col-span-1">
                    <div class="bg-gray-50 rounded-xl p-6 sticky top-24">
                        <h2 class="text-2xl font-bold text-deep-black mb-6">Order Summary</h2>
                        
                        <!-- Summary Loading -->
                        <div id="summary-loading" class="space-y-3">
                            <div class="skeleton h-6 rounded"></div>
                            <div class="skeleton h-6 rounded"></div>
                            <div class="skeleton h-8 rounded"></div>
                        </div>

                        <!-- Summary Content -->
                        <div id="summary-content" class="hidden space-y-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Subtotal</span>
                                <span id="subtotal" class="font-medium">â‚¦0.00</span>
                            </div>
                            <div class="flex justify-between">
                               
                            </div>
                            <div class="border-t border-gray-200 pt-4">
                                <div class="flex justify-between text-lg font-bold">
                                    <span>Total</span>
                                    <span id="total" class="text-2xl text-gold">â‚¦0.00</span>
                                </div>
                            </div>
                            
                            <!-- Delivery Estimate -->
                            <div class="mt-6 p-4 bg-white rounded-lg border border-gray-200">
                                <div class="flex items-center gap-3 mb-2">
                                    <i class="fas fa-truck text-gold"></i>
                                    <span class="font-medium">Delivery Estimate</span>
                                </div>
                                <p class="text-sm text-gray-600">3-5 business days within Nigeria</p>
                                <p class="text-sm text-gray-600"></p>
                            </div>

                            <!-- Checkout Button -->
                            <button id="checkout-btn" 
                                    onclick="proceedToCheckout()"
                                    class="w-full py-4 bg-deep-black text-white rounded-xl font-semibold hover:bg-gold transition-all duration-300 mt-6 disabled:opacity-50 disabled:cursor-not-allowed"
                                    disabled>
                                Proceed to Checkout
                            </button>

                            <!-- Continue Shopping -->
                            <a href="/products" 
                               class="block w-full py-3 bg-white border border-deep-black text-deep-black text-center rounded-xl font-medium hover:bg-gray-50 transition mt-3">
                                Continue Shopping
                            </a>

                            <!-- Payment Methods -->
                            <div class="mt-6 pt-6 border-t border-gray-200">
                                <p class="text-sm text-gray-600 mb-3">We accept:</p>
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-6 bg-gray-200 rounded flex items-center justify-center">
                                        <i class="fas fa-university text-gray-500"></i>
                                    </div>
                                    <div class="w-10 h-6 bg-gray-200 rounded flex items-center justify-center">
                                        <i class="fas fa-credit-card text-gray-500"></i>
                                    </div>
                                    <span class="text-sm text-gray-500">Bank Transfer & Cash on Delivery</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recently Viewed -->
            <div class="mt-16 pt-12 border-t border-gray-200">
                <h2 class="text-2xl font-bold text-deep-black mb-6">You might also like</h2>
                <div id="recommended-products" class="grid grid-cols-2 md:grid-cols-4 gap-6">
                    <!-- Recommended products will load here -->
                </div>
            </div>
        </div>
    </main>
 <footer class="bg-deep-black text-white py-16 sm:py-24 text-center">
    <div class="max-w-3xl mx-auto px-4 sm:px-6">
        <h2 class="text-3xl sm:text-4xl font-bold text-gold mb-4">
            Naija Style Co
        </h2>
        <p class="text-gray-400 text-base sm:text-lg mb-6">
            We're preparing something amazing.  
        </p>
        <p class="text-gray-300 text-lg sm:text-xl font-semibold">
            Coming Soon
        </p>

        <div class="border-t border-gray-800 mt-10 pt-6 text-gray-500 text-sm">
            <p>&copy; 2025 Naija Style Co. All rights reserved.</p>
        </div>
    </div>
</footer>

    <script>
        const API_URL = "http://localhost:5000";
        let cartItems = [];
        let currentUser = null;
        let recommendedProducts = [];

        // DOM Elements
        const elements = {
            cartLoading: document.getElementById('cart-loading'),
            emptyCart: document.getElementById('empty-cart'),
            cartItems: document.getElementById('cart-items'),
            summaryLoading: document.getElementById('summary-loading'),
            summaryContent: document.getElementById('summary-content'),
            subtotal: document.getElementById('subtotal'),
            total: document.getElementById('total'),
            checkoutBtn: document.getElementById('checkout-btn'),
            cartBadge: document.getElementById('cart-badge'),
            recommendedProducts: document.getElementById('recommended-products'),
            userSection: document.getElementById('user-section'),
            mobileUserSection: document.getElementById('mobile-user-section'),
            mobileMenu: document.getElementById('mobile-menu'),
            mobileBtn: document.getElementById('mobile-menu-btn'),
            mobileClose: document.getElementById('mobile-close')
        };

        // Initialize the cart page
        async function init() {
            console.log('ðŸ›’ Initializing Cart Page...');
            
            // Check authentication
            const token = localStorage.getItem('access_token');
            if (!token) {
                showToast('Please login to view your cart', 'error');
                setTimeout(() => {
                    window.location.href = '/auth/login';
                }, 1500);
                return;
            }
            
            // Load user state
            await loadUserState();
            
            // Load cart items
            await loadCartItems();
            
            // Load recommended products
            await loadRecommendedProducts();
            
            // Setup mobile menu
            setupMobileMenu();
        }

        // Load user state
        async function loadUserState() {
            const token = localStorage.getItem('access_token');
            if (!token) return;
            
            try {
                const res = await fetch(`${API_URL}/api/auth/me`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (res.ok) {
                    currentUser = await res.json();
                    renderLoggedIn();
                }
            } catch (err) {
                console.error('Error loading user:', err);
                renderGuest();
            }
        }

        // Load cart items
        async function loadCartItems() {
            if (!currentUser) return;
            
            try {
                console.log('ðŸ“¦ Loading cart items...');
                const res = await fetch(`${API_URL}/cart/${currentUser._id}`, {
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('access_token')}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (res.ok) {
                    const data = await res.json();
                    cartItems = data.items || [];
                    
                    // Update cart badge
                    updateCartBadge(data.total_items || 0);
                    
                    // Hide loading, show content
                    elements.cartLoading.classList.add('hidden');
                    elements.summaryLoading.classList.add('hidden');
                    
                    if (cartItems.length === 0) {
                        elements.emptyCart.classList.remove('hidden');
                        elements.summaryContent.classList.add('hidden');
                        elements.checkoutBtn.disabled = true;
                    } else {
                        elements.emptyCart.classList.add('hidden');
                        elements.cartItems.classList.remove('hidden');
                        elements.summaryContent.classList.remove('hidden');
                        elements.checkoutBtn.disabled = false;
                        
                        renderCartItems();
                        updateOrderSummary();
                    }
                } else {
                    throw new Error('Failed to load cart');
                }
            } catch (error) {
                console.error('âŒ Error loading cart:', error);
                elements.cartLoading.classList.add('hidden');
                elements.summaryLoading.classList.add('hidden');
                elements.emptyCart.classList.remove('hidden');
                showToast('Failed to load cart items', 'error');
            }
        }

        // Render cart items
        function renderCartItems() {
            elements.cartItems.innerHTML = '';
            
            cartItems.forEach((item, index) => {
                const cartItem = document.createElement('div');
                cartItem.className = 'bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden fade-in';
                cartItem.style.animationDelay = `${index * 0.05}s`;
                
                cartItem.innerHTML = `
                    <div class="p-4">
                        <div class="flex items-start gap-4">
                            <!-- Product Image -->
                            <div class="w-24 h-24 flex-shrink-0 bg-gray-100 rounded-lg overflow-hidden">
                                <img src="${item.image || 'https://picsum.photos/200/200?random=' + index}" 
                                     alt="${item.name}" 
                                     class="w-full h-full object-cover"
                                     onerror="this.src='https://picsum.photos/200/200?random=' + ${index}">
                            </div>
                            
                            <!-- Product Details -->
                            <div class="flex-1 min-w-0">
                                <div class="flex justify-between items-start">
                                    <div class="flex-1 pr-4">
                                        <h3 class="font-semibold text-deep-black mb-1 truncate">${item.name}</h3>
                                        <p class="text-lg font-bold text-gold mb-2">â‚¦${item.price.toLocaleString()}</p>
                                        <div class="flex items-center gap-2 mb-3">
                                            <span class="text-sm ${item.stock > 10 ? 'text-red-600' : item.stock > 0 ? 'text-amber-600' : 'text-red-600'}">
                                                ${item.stock > 10 ? 'In Stock' : item.stock > 0 ? `${item.stock} left` : 'Out of Stock'}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <!-- Remove Button -->
                                    <button onclick="removeFromCart('${item.product_id}')" 
                                            class="text-gray-400 hover:text-red-500 transition">
                                        <i class="fas fa-times text-xl"></i>
                                    </button>
                                </div>
                                
                                <!-- Quantity Controls -->
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-3">
                                        <button onclick="updateQuantity('${item.product_id}', ${item.quantity - 1})" 
                                                class="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                                                ${item.quantity <= 1 ? 'disabled' : ''}>
                                            <i class="fas fa-minus text-sm"></i>
                                        </button>
                                        <span class="w-12 text-center font-medium">${item.quantity}</span>
                                        <button onclick="updateQuantity('${item.product_id}', ${item.quantity + 1})" 
                                                class="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                                                ${item.stock <= item.quantity ? 'disabled' : ''}>
                                            <i class="fas fa-plus text-sm"></i>
                                        </button>
                                    </div>
                                    
                                    <!-- Item Total -->
                                    <div class="text-right">
                                        <p class="text-sm text-gray-500">Item Total</p>
                                        <p class="text-xl font-bold text-gold">â‚¦${(item.price * item.quantity).toLocaleString()}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                elements.cartItems.appendChild(cartItem);
            });
        }

        // Update order summary
        function updateOrderSummary() {
            const subtotal = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            elements.subtotal.textContent = `â‚¦${subtotal.toLocaleString()}`;
            elements.total.textContent = `â‚¦${subtotal.toLocaleString()}`;
            
            // Enable/disable checkout based on stock availability
            const hasOutOfStock = cartItems.some(item => item.stock <= 0);
            const hasLowStock = cartItems.some(item => item.quantity > item.stock);
            
            if (hasOutOfStock || hasLowStock) {
                elements.checkoutBtn.disabled = true;
                elements.checkoutBtn.innerHTML = `
                    <i class="fas fa-exclamation-triangle mr-2"></i>
                    ${hasOutOfStock ? 'Remove out of stock items' : 'Adjust quantities'}
                `;
            } else {
                elements.checkoutBtn.disabled = false;
                elements.checkoutBtn.innerHTML = `
                    <i class="fas fa-lock mr-2"></i>
                    Proceed to Checkout
                `;
            }
        }

        // Update quantity
        async function updateQuantity(productId, newQuantity) {
            if (newQuantity < 1) return;
            
            try {
                const res = await fetch(`${API_URL}/cart/${currentUser._id}/update`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('access_token')}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        product_id: productId,
                        quantity: newQuantity
                    })
                });
                
                if (res.ok) {
                    await loadCartItems();
                    showToast('Cart updated', 'success');
                } else {
                    const error = await res.json();
                    showToast(error.error || 'Failed to update cart', 'error');
                }
            } catch (error) {
                console.error('Error updating quantity:', error);
                showToast('Network error', 'error');
            }
        }

        // Remove item from cart
        async function removeFromCart(productId) {
            try {
                const res = await fetch(`${API_URL}/cart/${currentUser._id}/update`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('access_token')}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        product_id: productId,
                        quantity: 0
                    })
                });
                
                if (res.ok) {
                    await loadCartItems();
                    showToast('Item removed from cart', 'success');
                }
            } catch (error) {
                console.error('Error removing item:', error);
                showToast('Failed to remove item', 'error');
            }
        }

        // Clear entire cart
        async function clearCart() {
            if (!confirm('Are you sure you want to clear your cart?')) return;
            
            try {
                const res = await fetch(`${API_URL}/cart/${currentUser._id}/clear`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('access_token')}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (res.ok) {
                    await loadCartItems();
                    showToast('Cart cleared', 'success');
                }
            } catch (error) {
                console.error('Error clearing cart:', error);
                showToast('Failed to clear cart', 'error');
            }
        }

        // Proceed to checkout
        function proceedToCheckout() {
            if (!currentUser) {
                showToast('Please login to checkout', 'error');
                return;
            }
            
            if (cartItems.length === 0) {
                showToast('Your cart is empty', 'error');
                return;
            }
            
            // Check stock availability
            const invalidItems = cartItems.filter(item => item.quantity > item.stock);
            if (invalidItems.length > 0) {
                showToast('Some items exceed available stock', 'error');
                return;
            }
            
            // Navigate to checkout page
            window.location.href = '/cart/checkout';
        }

        // Load recommended products
        async function loadRecommendedProducts() {
            try {
                const res = await fetch(`${API_URL}/featured-products?limit=4`);
                if (res.ok) {
                    recommendedProducts = await res.json();
                    renderRecommendedProducts();
                }
            } catch (error) {
                console.error('Error loading recommended products:', error);
            }
        }

        // Render recommended products
        function renderRecommendedProducts() {
            elements.recommendedProducts.innerHTML = '';
            
            recommendedProducts.slice(0, 4).forEach((product, index) => {
                const stock = product.stock || product.stock_quantity || 0;
                const stockDisplay = stock > 10 ? 'In Stock' : `${stock} remaining`;
                const stockClass = stock > 10 ? 'bg-red-100 text-red-800' : 'bg-amber-100 text-amber-800';
                
                const productCard = document.createElement('div');
                productCard.className = 'group';
                productCard.innerHTML = `
                    <div class="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow">
                        <div class="aspect-square bg-gray-100 overflow-hidden cursor-pointer" onclick="location.href='/product/${product._id}'">
                            <img src="${product.images?.[0] || 'https://picsum.photos/400/400?random=' + index}" 
                                 alt="${product.name}" 
                                 class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500">
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold text-deep-black mb-2 truncate">${product.name}</h3>
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-lg font-bold text-gold">â‚¦${product.price.toLocaleString()}</span>
                                <span class="px-2 py-1 ${stockClass} rounded-full text-xs font-bold">
                                    ${stockDisplay}
                                </span>
                            </div>
                            <button onclick="addToCartFromCartPage('${product._id}')" 
                                    class="w-full py-2 bg-deep-black text-white text-sm rounded-lg font-medium hover:bg-gold transition">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                `;
                
                elements.recommendedProducts.appendChild(productCard);
            });
        }

        // Add to cart from cart page
        window.addToCartFromCartPage = async function(productId) {
            try {
                const res = await fetch(`${API_URL}/cart/${currentUser._id}/add`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('access_token')}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        product_id: productId,
                        quantity: 1
                    })
                });
                
                if (res.ok) {
                    await loadCartItems();
                    showToast('Added to cart', 'success');
                }
            } catch (error) {
                console.error('Error adding to cart:', error);
                showToast('Failed to add to cart', 'error');
            }
        };

        // Update cart badge
        function updateCartBadge(count) {
            elements.cartBadge.textContent = count > 99 ? '99+' : count;
        }

        // Render logged in state
        function renderLoggedIn() {
            const initials = ((currentUser.first_name?.[0] || '') + (currentUser.last_name?.[0] || '')).toUpperCase() || 'NS';
            const name = `${currentUser.first_name || ''} ${currentUser.last_name || ''}`.trim() || 'User';

            elements.userSection.innerHTML = `
                <div class="relative group">
                    <div class="w-12 h-12 bg-gradient-to-br from-gold to-red-700 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-xl cursor-pointer">
                        ${initials}
                    </div>
                    <div class="absolute right-0 top-16 w-72 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300">
                        <div class="p-6 bg-gradient-to-r from-gold/5 to-red-50/50 border-b border-gray-100">
                            <p class="font-semibold text-deep-black text-lg">${name}</p>
                            <p class="text-sm text-gray-600">${currentUser.email}</p>
                        </div>
                        
                        <a href="/orders" class="block px-6 py-4 hover:bg-gold/10 transition">My Orders</a>
                     
                        <button onclick="logout()" class="w-full text-left px-6 py-4 hover:bg-red-50 hover:text-red-600 transition flex items-center space-x-3">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </button>
                    </div>
                </div>
            `;

            elements.mobileUserSection.innerHTML = `
                <div class="space-y-6">
                    <div class="text-center">
                        <div class="w-20 h-20 bg-gradient-to-br from-gold to-red-700 rounded-full flex items-center justify-center text-white font-bold text-2xl mx-auto mb-4">
                            ${initials}
                        </div>
                        <p class="font-semibold text-lg">${name}</p>
                        <p class="text-gray-600">${currentUser.email}</p>
                    </div>
                    <div class="space-y-4">
                       
                        <a href="/orders" class="block text-2xl text-center text-black hover:text-gold transition">My Orders</a>
                     
                        <button onclick="logout()" class="w-full text-2xl text-center text-red-400 hover:text-red-300 transition">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
            `;
        }

        // Render guest state
        function renderGuest() {
            elements.userSection.innerHTML = `
                <a href="/auth/login" class="flex items-center space-x-3 hover:text-gold transition">
                    <i class="fas fa-user text-2xl text-deep-black"></i>
                    <span class="hidden md:block font-medium">Account</span>
                </a>
            `;
            elements.mobileUserSection.innerHTML = `
                <a href="/auth/login" class="text-3xl text-black hover:text-gold transition">Login</a>
            `;
        }

        // Logout function
        window.logout = function() {
            localStorage.removeItem('access_token');
            localStorage.removeItem('refresh_token');
            localStorage.removeItem('user');
            location.reload();
        };

        // Setup mobile menu
        function setupMobileMenu() {
            elements.mobileBtn.onclick = () => {
                elements.mobileMenu.classList.remove('hidden');
                setTimeout(() => elements.mobileMenu.classList.add('open'), 10);
            };
            
            elements.mobileClose.onclick = () => {
                elements.mobileMenu.classList.remove('open');
                setTimeout(() => elements.mobileMenu.classList.add('hidden'), 650);
            };
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-xl text-white transform transition-all duration-300 ${
                type === 'success' ? 'bg-red-600' : 
                type === 'error' ? 'bg-red-600' : 
                'bg-blue-600'
            }`;
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>